# Story 1.1: 项目结构搭建

## Status
Draft

## Story

**As a** 开发团队负责人,
**I want** 建立完整的Monorepo项目结构,
**so that** 团队协作开发，统一管理前后端代码和配置。

## Acceptance Criteria

1. 创建完整的Monorepo目录结构，包含core/、api/、ui/、shared/、config/、tests/等目录
2. 配置Python虚拟环境和依赖管理(poetry/pipenv)
3. 设置前端React项目和TypeScript配置
4. 建立代码格式化和质量检查工具(prettier, eslint, black, flake8)
5. 配置Git工作流和提交规范

## Tasks / Subtasks

- [ ] 创建Monorepo根目录结构 (AC: #1)
  - [ ] 创建core/目录 - 核心AI引擎代码
    - [ ] core/agents/ - S-A-F-E-E Agent实现
    - [ ] core/orchestrator/ - Agent协调器
    - [ ] core/models/ - 数据模型
  - [ ] 创建api/目录 - FastAPI接口层
    - [ ] api/routes/ - API路由定义
    - [ ] api/middleware/ - 中间件
    - [ ] api/schemas/ - 数据结构定义
  - [ ] 创建ui/目录 - React前端代码
    - [ ] ui/src/ - 源代码
    - [ ] ui/public/ - 静态资源
    - [ ] ui/components/ - React组件
  - [ ] 创建shared/目录 - 共享工具和配置
    - [ ] shared/utils/ - 工具函数
    - [ ] shared/types/ - 类型定义
    - [ ] shared/config/ - 配置文件
  - [ ] 创建config/目录 - 配置文件和部署脚本
  - [ ] 创建tests/目录 - 测试代码
    - [ ] tests/unit/ - 单元测试
    - [ ] tests/integration/ - 集成测试
    - [ ] tests/e2e/ - 端到端测试
  - [ ] 创建docs/目录 - 技术文档
  - [ ] 创建根级别配置文件

- [ ] 配置Python开发环境 (AC: #2)
  - [ ] 选择并配置依赖管理工具(poetry优先，备选pipenv)
  - [ ] 创建pyproject.toml配置文件
  - [ ] 配置Python虚拟环境
  - [ ] 安装核心依赖包(fastapi, sqlalchemy, psycopg2, redis等)
  - [ ] 配置开发依赖包(black, flake8, pytest, mypy等)
  - [ ] 创建requirements.txt文件(兼容性)

- [ ] 设置前端React项目 (AC: #3)
  - [ ] 初始化React 18项目
  - [ ] 配置TypeScript支持
  - [ ] 设置ESLint和Prettier配置
  - [ ] 配置构建工具(Vite或Create React App)
  - [ ] 设置CSS预处理器(Styled-components或CSS Modules)
  - [ ] 配置路由和状态管理基础

- [ ] 建立代码质量工具链 (AC: #4)
  - [ ] 配置Python代码格式化工具(black)
  - [ ] 配置Python代码检查工具(flake8, mypy)
  - [ ] 配置前端代码格式化工具(prettier)
  - [ ] 配置前端代码检查工具(eslint)
  - [ ] 设置pre-commit hooks
  - [ ] 配置CI/CD基础检查

- [ ] 配置Git工作流 (AC: #5)
  - [ ] 创建.gitignore文件
  - [ ] 配置分支策略(main, develop, feature/*)
  - [ ] 设置提交信息规范(Conventional Commits)
  - [ ] 创建提交模板
  - [ ] 配置Git hooks
  - [ ] 编写Git工作流文档

## Dev Notes

### 技术架构信息
本项目采用Monorepo架构，统一管理前后端代码。主要技术栈：
- 后端: Python 3.9+ + FastAPI + SQLAlchemy + PostgreSQL + Redis
- 前端: React 18 + TypeScript + Ant Design
- 容器化: Docker + Docker Compose
- 开发工具: Poetry + Black + Flake8 + ESLint + Prettier

### 源代码树结构
```
SAFE-BMAD/
├── core/                   # 核心AI引擎
│   ├── agents/            # S-A-F-E-E Agent实现
│   ├── orchestrator/      # Agent协调器
│   └── models/           # 数据模型
├── api/                   # FastAPI接口层
│   ├── routes/           # API路由
│   ├── middleware/       # 中间件
│   └── schemas/          # 数据结构
├── ui/                    # React前端
│   ├── src/
│   │   ├── components/
│   │   ├── pages/
│   │   └── utils/
│   └── public/
├── shared/                # 共享代码
│   ├── utils/
│   ├── types/
│   └── config/
├── config/                # 配置文件
├── tests/                 # 测试代码
├── docs/                  # 技术文档
├── docker-compose.yml     # 开发环境
├── pyproject.toml         # Python配置
└── README.md             # 项目说明
```

### 相关配置文件
- pyproject.toml: Python项目配置和依赖管理
- package.json: 前端项目配置
- .gitignore: Git忽略文件
- .pre-commit-config.yaml: Pre-commit hooks配置
- docker-compose.yml: 开发环境容器配置

### 依赖关系说明
- 本故事是Epic 1的第一个故事，无前置依赖
- 完成本故事后，团队可以开始其他基础环境配置工作
- 为后续的数据库设计、API开发提供基础项目结构

### 重要注意事项
- 确保目录结构符合团队开发习惯
- 配置文件需要支持跨平台开发(Windows/macOS/Linux)
- 代码质量工具需要集成到IDE中，提供实时反馈
- Git工作流需要结合团队规模和项目特点进行调整

### Testing

#### 测试标准
- 测试文件位置: tests/目录下按类型分类
- 单元测试: tests/unit/ - 使用pytest框架
- 集成测试: tests/integration/ - 测试组件间集成
- 端到端测试: tests/e2e/ - 测试完整用户流程

#### 测试框架和模式
- 后端测试: pytest + pytest-asyncio + pytest-cov
- 前端测试: Jest + React Testing Library
- 测试覆盖率要求: 最低70%，推荐80%+
- 测试命名规范: test_*.py文件，test_*函数

#### 特定测试要求
- 项目结构创建后需要验证目录权限和可访问性
- Python环境配置需要验证依赖安装和虚拟环境激活
- 前端项目配置需要验证构建和启动流程
- 代码质量工具需要验证配置正确性和实际效果

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-10-20 | 1.0 | 初始故事创建 | John (PM) |

## Dev Agent Record

### Agent Model Used
(待开发时填写)

### Debug Log References
(待开发时填写)

### Completion Notes List
(待开发时填写)

### File List
(待开发时填写)

## QA Results
(待QA测试时填写)